<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Multivariate analysis</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Fungal Networks</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="Multivariate.html">Multivariate analysis</a>
</li>
<li>
  <a href="analysis_igraph.html">Analysis with Igraph</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Multivariate analysis</h1>

</div>


<div id="multivariate-analysis-of-network-data" class="section level1">
<h1>Multivariate Analysis of Network data</h1>
<p>Note: This tutorial is bascially the same as the on described in “Protocol_multivariate.R”. Either download the repo or, much easier, just copy the script and paste into your r script.</p>
<div id="intro-basics" class="section level2">
<h2>Intro &amp; Basics</h2>
<p>The question addressed here is whether network traits “cluster” according to species identity For this we are using:</p>
<ul>
<li>PCA: To visualize whether there is any clustering</li>
<li>Difference in the correlations among variables per species</li>
<li>PERMANOVA: to test difference among groups</li>
</ul>
<p>To do that I use base R functions combined with functions from three other packages: vegan, tidyverse and RColorBrewer You might need to install those packages. You can do that via R studio or:</p>
</div>
<div id="loading-files." class="section level2">
<h2>1. Loading files.</h2>
<p>Note: one can load directly excel files (.xlxs) using R studio. This is a relatively new feature. I am used to the function “read.csv” for which I need to save the excel sheet I am interested as a csv file first. In this case, I saved the “edge” sheet of each excel file of each of the 6 species as .csv</p>
</div>
</div>
<div id="first-edge-files" class="section level1">
<h1>First Edge files</h1>
<pre class="r"><code>#These lines will load all files saved as .csv in the folder &quot;processedData&quot; and then merging them (&quot;row bind&quot;)
temp = list.files(path=&quot;processedData\\&quot;,pattern=&quot;*-Edge.csv&quot;)
temp&lt;-paste(&quot;processedData\\&quot;,temp,sep = &quot;&quot;)
myfiles = lapply(temp,function(x){read.csv(x,header = TRUE,stringsAsFactors = FALSE)} )
#myfiles[[4]]&lt;-myfiles[[4]][,c(1:42)]
Edge_Traits&lt;-do.call(rbind,myfiles)

Edge_Traits$Species&lt;-NA
Edge_Traits$Species[grep(&quot;C34&quot;,Edge_Traits$name)]&lt;-&quot;Mortierella elongata&quot;
Edge_Traits$Species[grep(&quot;C35&quot;,Edge_Traits$name)]&lt;-&quot;Umbelopsis isabellina&quot;
Edge_Traits$Species[grep(&quot;DF19&quot;,Edge_Traits$name)]&lt;-&quot;Mortierella alpina&quot;
Edge_Traits$Species[grep(&quot;DF25&quot;,Edge_Traits$name)]&lt;-&quot;Mortierella elongata2&quot;
Edge_Traits$Species[grep(&quot;DF56&quot;,Edge_Traits$name)]&lt;-&quot;Mucor fragilis&quot;
Edge_Traits$Species[grep(&quot;M&quot;,Edge_Traits$name)]&lt;-&quot;Mortierella alpina2&quot;

#Assuming the Or_ij can be expressed from 0 to 360 degrees
Edge_Traits$Or_ij[which(Edge_Traits$Or_ij&lt;0)]&lt;-(Edge_Traits$Or_ij[which(Edge_Traits$Or_ij&lt;0)]*-1)+180

Edge_Traits&lt;-Edge_Traits[which(Edge_Traits$Type==&quot;E&quot;),]

#I am removing seven values with Width=0
Edge_Traits&lt;-Edge_Traits[-which(Edge_Traits$Width==0),]</code></pre>
</div>
<div id="adding-nodes" class="section level1">
<h1>Adding nodes</h1>
<pre class="r"><code>temp = list.files(path=&quot;processedData\\&quot;,pattern=&quot;*-Node.csv&quot;)
temp&lt;-paste(&quot;processedData\\&quot;,temp,sep = &quot;&quot;)
myfiles = lapply(temp,function(x){read.csv(x,header = TRUE,stringsAsFactors = FALSE,sep = &quot;;&quot;)} )
#myfiles[[4]]&lt;-myfiles[[4]][,c(1:42)]
Node_Traits&lt;-do.call(rbind,myfiles)

Node_Traits$node_name_ID&lt;-paste(Node_Traits$name,Node_Traits$node_ID,sep = &quot;_&quot;)

#Edge_Traits_o&lt;-Edge_Traits</code></pre>
<p>#Merging them</p>
<pre class="r"><code>#For the first node
trial&lt;-
left_join(Edge_Traits%&gt;%
            mutate(node_name_ID=paste(name,EndNodes_1,sep = &quot;_&quot;)),
          Node_Traits[,c(&quot;node_name_ID&quot;,&quot;node_Type&quot;,&quot;node_Degree&quot;)])

trial&lt;-trial%&gt;%
  rename(node_1_name_ID=node_name_ID)%&gt;%
  rename(EndNodes_1_Type=node_Type)%&gt;%
  rename(EndNodes_1_Degree=node_Degree)


#For the second node
trial&lt;-
left_join(trial%&gt;%
            mutate(node_name_ID=paste(name,EndNodes_2,sep = &quot;_&quot;)),
          Node_Traits[,c(&quot;node_name_ID&quot;,&quot;node_Type&quot;,&quot;node_Degree&quot;)])

trial&lt;-trial%&gt;%
  rename(node_2_name_ID=node_name_ID)%&gt;%
  rename(EndNodes_2_Type=node_Type)%&gt;%
  rename(EndNodes_2_Degree=node_Degree)

Edge_Traits_o&lt;-Edge_Traits
Edge_Traits&lt;-trial;rm(trial)</code></pre>
<div id="getting-to-know-the-data." class="section level2">
<h2>2. Getting to know the data.</h2>
<div id="how-r-sees-the-data." class="section level3">
<h3>2.1 How R sees the data.</h3>
<p>It is useful to have an idea on how R recognize the data. R is an “object oriented” program language. That is, every data is an object which has certain properties. R uses these properties to categorized the object. It is useful to know what kind of object is your data because some functions only work on one object type but not in others.</p>
<pre class="r"><code>str(Edge_Traits)</code></pre>
</div>
<div id="understanding-the-variables-and-their-distribution." class="section level3">
<h3>2.2. Understanding the variables and their distribution.</h3>
<p>More impotantly, what is the distribution of the data? To simply get means, min, max per fungal species per variable:</p>
<pre class="r"><code>aggregate(
        Edge_Traits[,
                         c(&quot;Width&quot;,&quot;Length&quot;,&quot;Area&quot;,&quot;Volume&quot;,&quot;Resistance_2ave&quot;,&quot;Tortuosity&quot;,&quot;Distance&quot;,
                           &quot;Accessibility&quot;,&quot;Betweenness&quot;,&quot;Route_factor&quot;,&quot;Or_ij&quot;)],
        by=list(Edge_Traits[which(Edge_Traits$Type==&quot;E&quot;),]$name),
        mean)#Here you  can write different functions: min, max, median. range and summmary is also good because it
                #gets you more than one summary statistics, but it can be confusing with so much data.</code></pre>
<p>I had some issues understanding what Resistance is. Playing with the following code allowed me to determine that Resistance_2ave = 10*(Length)/width^2</p>
<pre class="r"><code>summary(Edge_Traits$Resistance_2ave)
length(which(Edge_Traits$Width_intact==0))
Edge_Traits%&gt;%
        #filter(Area!=0)%&gt;%
        #filter(Resistance_2ave&gt;500)%&gt;%
        mutate(MyResistance=Length/(Width/2)^2)%&gt;%
        mutate(Factor=Resistance_2ave/MyResistance)%&gt;%
        select(Species,name,Length,Width,Resistance_2ave)%&gt;%
        ggplot()+
        aes(y=Resistance_2ave,x=name,fill=name)+
        geom_boxplot()+
        facet_grid(. ~ Species, scales = &quot;free&quot;)+
        theme(legend.position = &quot;none&quot;)
  

length(which(Edge_Traits$Resistance_2ave&gt;500))</code></pre>
<p>About tortuosity</p>
<pre class="r"><code>tapply(Edge_Traits$Tortuosity,Edge_Traits$name,summary)
tapply(Edge_Traits$Tortuosity,Edge_Traits$name,function(x){length(which(x&gt;1.5))})
tapply(Edge_Traits$Tortuosity,Edge_Traits$name,function(x){length(which(x&gt;1.5))/length(x)})
tapply(Edge_Traits$Tortuosity,Edge_Traits$name,function(x){length(which(x&gt;1.5))})
tapply(Edge_Traits$Tortuosity,Edge_Traits$name,length)</code></pre>
<pre class="r"><code>Hist_Length_Tortuosity_4&lt;-
Edge_Traits%&gt;%
        filter(Tortuosity&lt;1.5)%&gt;%
        select(c(&quot;name&quot;,&quot;Species&quot;,&quot;Width&quot;,&quot;Length&quot;,&quot;Area&quot;,&quot;Volume&quot;,&quot;Resistance_2ave&quot;,&quot;Tortuosity&quot;,&quot;Distance&quot;,
                 &quot;Accessibility&quot;,&quot;Betweenness&quot;,&quot;Route_factor&quot;,&quot;Or_ij&quot;))%&gt;%
        group_by(name)%&gt;%
        gather(key=variable,
               value=value,Width:Or_ij)%&gt;%
        
        filter(variable %in% c(&quot;Length&quot;,&quot;Tortuosity&quot;))%&gt;%#4_Tortuosity has little variation and depends on Length
        ggplot()+
        aes(value,fill=name)+
        geom_histogram()+
        facet_wrap(Species ~ variable, scales = &quot;free&quot;,nrow = 6,ncol = 2)+
        theme(legend.position = &quot;none&quot;)</code></pre>
<div id="visualizing-the-distribution-of-the-data" class="section level4">
<h4>Visualizing the distribution of the data</h4>
<p>Note: I am grouping the variables in different sets. Each set represents (to me) an intuitively logical set of related variables</p>
<pre class="r"><code>Hist_Width_Length_Distance_1
Hist_Width_Length_Area_Vol_2
Hist_Width_Length_Resistance_3
Hist_Length_Tortuosity_4
Hist_Resistance_Accessibility_Betweenness_5
Hist_Distance_Route_factor_6</code></pre>
<p>Form these plots one learns that:</p>
<ol style="list-style-type: decimal">
<li>Some variables are mathematically correlated:</li>
</ol>
<ul>
<li>Area= (pi/4)*Width^2</li>
<li>Volume= (pi/4)<em>(Width^2)</em>Length</li>
<li><p>Resitance= 10*Length/Width^2</p></li>
<li>Thus for subsequent analysis I will only use variables that are not (at least so easily) related to each other:
<ul>
<li>Width, Lenght, Tortuosity, Distance, Accessibility, Betweenness, Route Factor</li>
</ul></li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>The distribution of the data for a variable is similar across ose species. In summary:</li>
</ol>
<ul>
<li>Width: Varies from almost uniform to normal to bimodal to right skewed, and this depends on the species</li>
<li>Length: left skewed</li>
<li>Torturosity: “A bit” normal, still data is concentrated to the left. It is completely left skewed with tortuosity values higher than 1.5 are included which only represent less than 1% of the data</li>
<li>Distance: Normally distributed</li>
<li>Accessibility: A bit" normal, still data is concentrated to the left</li>
<li>Betwenness: Highly right skewed</li>
<li>Route Factor: A bit" normal, still data is concentrated to the left</li>
</ul>
<p>What kind of transformations are needed for betweeness, Length (the ones that are clearly left-skewed) and Tortuosity</p>
<p>Betweenness can be log transformed (adding 1)</p>
<pre class="r"><code>Edge_Traits%&gt;%
        #filter(Tortuosity&lt;1.5)%&gt;%
        select(c(&quot;name&quot;,&quot;Species&quot;,&quot;Width&quot;,&quot;Length&quot;,&quot;Area&quot;,&quot;Volume&quot;,&quot;Resistance_2ave&quot;,&quot;Tortuosity&quot;,&quot;Distance&quot;,
                 &quot;Accessibility&quot;,&quot;Betweenness&quot;,&quot;Route_factor&quot;,&quot;Or_ij&quot;))%&gt;%
        mutate(Log_Betweenness=log10(Betweenness+1))%&gt;%
        group_by(name)%&gt;%
        gather(key=variable,
               value=value,Width:Log_Betweenness)%&gt;%
        
        filter(variable %in% c(&quot;Log_Betweenness&quot;,&quot;Distance&quot;))%&gt;%#4_Tortuosity has little variation and depends on Length
        ggplot()+
        aes(value,fill=name)+
        geom_histogram()+
        facet_wrap(Species ~ variable, scales = &quot;free&quot;,nrow = 6,ncol = 2)+
        theme(legend.position = &quot;none&quot;)</code></pre>
<p>Length can be log transformed and that makes it very normally ditributed</p>
<pre class="r"><code>Edge_Traits%&gt;%
        #filter(Tortuosity&lt;1.5)%&gt;%
        select(c(&quot;name&quot;,&quot;Species&quot;,&quot;Width&quot;,&quot;Length&quot;,&quot;Area&quot;,&quot;Volume&quot;,&quot;Resistance_2ave&quot;,&quot;Tortuosity&quot;,&quot;Distance&quot;,
                 &quot;Accessibility&quot;,&quot;Betweenness&quot;,&quot;Route_factor&quot;,&quot;Or_ij&quot;))%&gt;%
        mutate(Log_Length=log10(Length))%&gt;%
        group_by(name)%&gt;%
        gather(key=variable,
               value=value,Width:Log_Length)%&gt;%
        
        filter(variable %in% c(&quot;Log_Length&quot;,&quot;Distance&quot;))%&gt;%#4_Tortuosity has little variation and depends on Length
        ggplot()+
        aes(value,fill=name)+
        geom_histogram()+
        facet_wrap(Species ~ variable, scales = &quot;free&quot;,nrow = 6,ncol = 2)+
        theme(legend.position = &quot;none&quot;)</code></pre>
</div>
</div>
<div id="understanding-relationships-among-variables." class="section level3">
<h3>2.3. Understanding relationships among variables.</h3>
<p>Before doing a correlogram of everything with everythin. Here I want to test specific relationships that I think might be interesting biologically</p>
<p>LENGTH AND WIDTH</p>
<pre class="r"><code>Length_Width
Log_Length_Width</code></pre>
<p>The only thing I can tell from this one is that the thinnest hyphae have medium size length. Really long hyphae cannot be thin. There seems to be a lower boundary: the thinnest hypahe get longer up to a point where it is impossible to go thinniest and long. Note! Assuming this follows the two are connected by a power law</p>
<p>LENGTH; WIDTH AND DISTANCE</p>
<pre class="r"><code>Log_Length_Distance</code></pre>
<p>Out of this one is clear that there is no relationship between length and distance</p>
<p>RESISTANCE WIDTH AND LENGTH (THIS IS MAINLY TO TEST THE MATHEMATICAL RELATIONSHIP AMONG THEM)</p>
<pre class="r"><code>Log_Resistance_Width_Length</code></pre>
<p>This plot confirms the relationship between resistance and lenght and width</p>
<p>BETWEENNESS AND DISTANCE</p>
<pre class="r"><code>Log_Betweenness_Distance</code></pre>
<p>ROUTE FACTOR AND WIDTH</p>
<pre class="r"><code>RouteFactor_Width</code></pre>
<p>Correlograms</p>
<pre class="r"><code>library(GGally)</code></pre>
</div>
<div id="correlograms-for-each-species" class="section level3">
<h3>Correlograms for each species</h3>
<pre class="r"><code>Edge_Traits%&gt;%
  filter(Species==&quot;Mortierella elongata&quot;)%&gt;%
  filter(Tortuosity&lt;1.5)%&gt;%
        
  mutate(Log_Betweenness=log10(Betweenness+1))%&gt;%
  mutate(Log_Length=log10(Length))%&gt;%
  mutate(Species=as.factor(Species))%&gt;%
  select(c(&quot;Width&quot;,&quot;Log_Length&quot;,&quot;Tortuosity&quot;,&quot;Distance&quot;,
                 &quot;Accessibility&quot;,&quot;Log_Betweenness&quot;,&quot;Route_factor&quot;,&quot;Species&quot;))%&gt;%
  ggpairs(title=&quot;Mortierella elongata&quot;,columns = 1:7,ggplot2::aes(color=Species))

Edge_Traits%&gt;%
  filter(Species==&quot;Umbelopsis isabellina&quot;)%&gt;%
  filter(Tortuosity&lt;1.5)%&gt;%
        
  mutate(Log_Betweenness=log10(Betweenness+1))%&gt;%
  mutate(Log_Length=log10(Length))%&gt;%
  mutate(Species=as.factor(Species))%&gt;%
  select(c(&quot;Width&quot;,&quot;Log_Length&quot;,&quot;Tortuosity&quot;,&quot;Distance&quot;,
                 &quot;Accessibility&quot;,&quot;Log_Betweenness&quot;,&quot;Route_factor&quot;,&quot;Species&quot;))%&gt;%
  ggpairs(title=&quot;Umbelopsis isabellina&quot;,columns = 1:7,ggplot2::aes(color=Species))


Edge_Traits%&gt;%
  filter(Species==&quot;Mortierella alpina&quot;)%&gt;%
  filter(Tortuosity&lt;1.5)%&gt;%
        
  mutate(Log_Betweenness=log10(Betweenness+1))%&gt;%
  mutate(Log_Length=log10(Length))%&gt;%
  mutate(Species=as.factor(Species))%&gt;%
  select(c(&quot;Width&quot;,&quot;Log_Length&quot;,&quot;Tortuosity&quot;,&quot;Distance&quot;,
                 &quot;Accessibility&quot;,&quot;Log_Betweenness&quot;,&quot;Route_factor&quot;,&quot;Species&quot;))%&gt;%
  ggpairs(title=&quot;Mortierella alpina&quot;,columns = 1:7,ggplot2::aes(color=Species))

Edge_Traits%&gt;%
  filter(Species==&quot;Mortierella elongata2&quot;)%&gt;%
  filter(Tortuosity&lt;1.5)%&gt;%
        
  mutate(Log_Betweenness=log10(Betweenness+1))%&gt;%
  mutate(Log_Length=log10(Length))%&gt;%
  mutate(Species=as.factor(Species))%&gt;%
  select(c(&quot;Width&quot;,&quot;Log_Length&quot;,&quot;Tortuosity&quot;,&quot;Distance&quot;,
                 &quot;Accessibility&quot;,&quot;Log_Betweenness&quot;,&quot;Route_factor&quot;,&quot;Species&quot;))%&gt;%
  ggpairs(title=&quot;Mortierella elongata2&quot;,columns = 1:7,ggplot2::aes(color=Species))

Edge_Traits%&gt;%
  filter(Species==&quot;Mucor fragilis&quot;)%&gt;%
  filter(Tortuosity&lt;1.5)%&gt;%
        
  mutate(Log_Betweenness=log10(Betweenness+1))%&gt;%
  mutate(Log_Length=log10(Length))%&gt;%
  mutate(Species=as.factor(Species))%&gt;%
  select(c(&quot;Width&quot;,&quot;Log_Length&quot;,&quot;Tortuosity&quot;,&quot;Distance&quot;,
                 &quot;Accessibility&quot;,&quot;Log_Betweenness&quot;,&quot;Route_factor&quot;,&quot;Species&quot;))%&gt;%
  ggpairs(title=&quot;Mucor fragilis&quot;,columns = 1:7,ggplot2::aes(color=Species))

Edge_Traits%&gt;%
  filter(Species==&quot;Mortierella alpina2&quot;)%&gt;%
  filter(Tortuosity&lt;1.5)%&gt;%
        
  mutate(Log_Betweenness=log10(Betweenness+1))%&gt;%
  mutate(Log_Length=log10(Length))%&gt;%
  mutate(Species=as.factor(Species))%&gt;%
  select(c(&quot;Width&quot;,&quot;Log_Length&quot;,&quot;Tortuosity&quot;,&quot;Distance&quot;,
                 &quot;Accessibility&quot;,&quot;Log_Betweenness&quot;,&quot;Route_factor&quot;,&quot;Species&quot;))%&gt;%
  ggpairs(title=&quot;Mortierella alpina2&quot;,columns = 1:7,ggplot2::aes(color=Species))</code></pre>
<div id="correlograms-for-all-species-together" class="section level4">
<h4>Correlograms for all species together</h4>
<pre class="r"><code>Edge_Traits%&gt;%
  #filter(Species==&quot;Mortierella elongata&quot;)%&gt;%
  filter(Tortuosity&lt;1.5)%&gt;%
        
  mutate(Log_Betweenness=log10(Betweenness+1))%&gt;%
  mutate(Log_Length=log10(Length))%&gt;%
  mutate(Species=as.factor(Species))%&gt;%
  select(c(&quot;Width&quot;,&quot;Log_Length&quot;,&quot;Tortuosity&quot;,&quot;Distance&quot;,
                 &quot;Accessibility&quot;,&quot;Log_Betweenness&quot;,&quot;Route_factor&quot;,&quot;Species&quot;))%&gt;%
  ggpairs(title=&quot;All&quot;,columns = 1:7)</code></pre>
</div>
</div>
</div>
</div>
<div id="visualizing-and-testing-the-clustering-of-species-in-trait-space" class="section level1">
<h1>Visualizing and testing the clustering of species in trait space</h1>
<div id="a-model-with-information-at-the-hyphal-level-showed-to-explain-very-little-the-variation-thus-it-is-not-worth-using-it.-thus-a-better-option-is-to-use-mean-values" class="section level5">
<h5>A model with information at the hyphal level showed to explain very little the variation, thus it is not worth using it. Thus a better option is to use mean values</h5>
</div>
<div id="results-from-rda" class="section level4">
<h4>Results from RDA</h4>
<div id="proportion-of-data-explained-by-constrained-axes" class="section level5">
<h5>Proportion of data explained by constrained axes</h5>
<pre class="r"><code>Model_descriptive_traits</code></pre>
</div>
</div>
<div id="proportion-of-data-explained-by-the-first-and-second-rda-axes" class="section level4">
<h4>Proportion of data explained by the first and second RDA axes</h4>
</div>
<div id="significance-testing-of-the-rda-permutation-based-test-of-vegan-package" class="section level4">
<h4>Significance testing of the RDA (permutation based test of vegan package)</h4>
</div>
<div id="clustering-based-on-descriptive-traits-widthlog_lengthtortuositylog_betweenness" class="section level3">
<h3>Clustering based on descriptive traits: “Width”,“Log_Length”,“Tortuosity”,“Log_Betweenness”</h3>
<pre class="r"><code>Descriptive_traits %&gt;% 
  ggplot()+
  aes(x=RDA1,y=RDA2,color=Species,label=Species) +
  geom_text() +
  scale_color_viridis_d()+
  labs(y=&quot;RDA2 8%&quot;,x=&quot;RDA1 80%&quot;)+
  my_theme</code></pre>
</div>
</div>
<div id="transport-to-tips-traits" class="section level1">
<h1>Transport to tips traits</h1>
<p>All relationships above consider each hyphal segment as separate replicate. This information is meaningful particularly for what I call the descriptive traits (width, lenght) but for the transport ones (accessibility) this is a bit misleading as the transport from on hyphal segment to the next one is not going to change that much (or at all). Thus I am going to make a new analysis, this time only based on “Routes”. That is the wholde path from the center of the inoculum to an endpoint.</p>
<div id="histograms-of-the-transport-traits-distanceaccessibilityroute_factorroute_length" class="section level4">
<h4>Histograms of the transport traits: “Distance”,“Accessibility”,“Route_factor”,“Route_Length”</h4>
<pre class="r"><code>        Re_org_2%&gt;%
  filter(EndNodes_1_Degree==1|EndNodes_2_Degree==1)%&gt;%
        filter(variable %in% c(&quot;Distance&quot;,&quot;Accessibility&quot;,&quot;Route_factor&quot;,&quot;Route_Length&quot;))%&gt;%#1_The completely indepedent variables
        ggplot()+
        aes(value,fill=name)+
        geom_histogram()+
        facet_wrap(Species ~ variable, scales = &quot;free&quot;,nrow = 6,ncol = 4)+
        theme(legend.position = &quot;none&quot;)</code></pre>
</div>
<div id="relationship-among-the-transport-traits" class="section level4">
<h4>Relationship among the transport traits</h4>
<pre class="r"><code>Edge_Traits%&gt;%
  mutate(Route_Length=Distance*Route_factor)%&gt;%
  filter(EndNodes_1_Degree==1|EndNodes_2_Degree==1)%&gt;%
  ggplot()+
  aes(y=Route_Length,x=Distance,color=name)+
    geom_point()+
  #geom_hex() +
  #geom_bin2d()+
  geom_point(alpha=0.8,size=2)+
  facet_wrap(. ~ Species, scales = &quot;free&quot;,nrow = 6,ncol = 3)+
  theme(legend.position = &quot;none&quot;)


Edge_Traits%&gt;%
  mutate(Route_Length=Distance*Route_factor)%&gt;%
  filter(EndNodes_1_Degree==1|EndNodes_2_Degree==1)%&gt;%
  ggplot()+
  aes(x=Route_Length,y=Accessibility,color=name)+
    geom_point()+
  #geom_hex() +
  #geom_bin2d()+
  geom_point(alpha=0.8,size=2)+
  facet_wrap(. ~ Species, scales = &quot;free&quot;,nrow = 6,ncol = 3)+
  theme(legend.position = &quot;none&quot;)</code></pre>
</div>
<div id="making-correlograms-for-these-transport-traits" class="section level4">
<h4>Making correlograms for these transport traits</h4>
<pre class="r"><code>Edge_Traits%&gt;%
  mutate(Route_Length=Distance*Route_factor)%&gt;%
  filter(EndNodes_1_Degree==1|EndNodes_2_Degree==1)%&gt;%
  
  mutate(Species=as.factor(Species))%&gt;%
  select(c(&quot;Distance&quot;,&quot;Accessibility&quot;,&quot;Route_factor&quot;,&quot;Route_Length&quot;,&quot;Species&quot;))%&gt;%
  ggpairs(title=&quot;All&quot;,columns = 1:4,ggplot2::aes(color=Species))</code></pre>
<p>Comment from Mark: Betweenness values less than one are a proxy of links that are not particularly useful because that route is never being used</p>
</div>
<div id="clustering-and-testing-the-signficance-of-the-clustering-for-these-transport-traits" class="section level4">
<h4>Clustering and testing the signficance of the clustering for these transport traits</h4>
<pre class="r"><code>Model_transport_traits
#               Inertia Proportion Rank
# Total            4.00       1.00     
# Constrained      2.76       0.69    4
# Unconstrained    1.24       0.31    4
# Inertia is correlations </code></pre>
<pre class="r"><code>summary(Model_transport_traits)[[&quot;cont&quot;]][[&quot;importance&quot;]][,c(1:2)]
#                       RDA1      RDA2
# Eigenvalue            1.6709939 0.8693697
# Proportion Explained  0.4177485 0.2173424
# Cumulative Proportion 0.4177485 0.6350909</code></pre>
<pre class="r"><code>anova.cca(Model_transport_traits,by=&quot;term&quot;)
#          Df   Variance  F       Pr(&gt;F)    
# Species   5   2.7598    4.4506  0.001 ***
# Residual 10   1.2402                  
#plot(Model_transport_traits$Ybar[,1],Transport_traits$Distance)</code></pre>
</div>
<div id="clustering-based-on-transport-traits-mean-values-per-replicate" class="section level3">
<h3>Clustering based on transport traits (mean values per replicate)</h3>
<pre class="r"><code>temporal&lt;-as.data.frame(scores(Model_transport_traits,display = &quot;sites&quot;,scaling = &quot;sites&quot;,choices=c(1,2)))

Transport_traits&lt;-cbind(Transport_traits,temporal);rm(temporal)

Transport_traits %&gt;% 
  ggplot()+
  aes(x=RDA1,y=RDA2,color=Species,label=Species) +
  geom_text() +
  scale_color_viridis_d()+
  labs(y=&quot;RDA2 21%&quot;,x=&quot;RDA1 41%&quot;)+
  my_theme</code></pre>
</div>
</div>
<div id="to-do-list" class="section level1">
<h1>To do list:</h1>
<p>Check how to deal with not anastomosis from the images… maybe removing the node degree higher or equal than 3… also check whether i can measure route factor in R</p>
<p>Other traits to include is the total length of the mycelium, and the total lenght divided by the number of hyphal segments</p>
<p>Revise again how do I know that the traits are not not adjusted to micrometers but pixels</p>
<p>Is mean length the same as the total length of the mycelium divided by the number of hyphae</p>
<p>Check again what is Ybar from the output of vegan</p>
<p>Check whether I got new data on the problmatic species including umpellopsis</p>
<p>Maybe the twist here is how to tell appart phenotypically species that are closely related to each other. I should ask Anika what is the evidence for the mucoromycota species to behave differently.</p>
<p>Think how to treat betweenness</p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
